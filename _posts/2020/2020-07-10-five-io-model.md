---
title: IO 的五种模型
author: Shaun
date: 2020-07-10 22:33:00 +0800
categories: [博客]
tags: [io]
math: true
mermaid: true
---

## 内核空间和用户空间

内核是操作系统的核心，它独立于普通应用程序，既拥有访问受保护的内核空间的权限，也拥有访问底层硬件设备的所有权限。

为保护内核安全，现代操作系统一般都强制用户进程不能直接操作内核，所以操作系统把**内存空间**划分成了两个部分：

- **内核空间**。
- **用户空间**。

> 好比：饭店老板将整个饭店划分成两个部分：**大厅**和**厨房**。大厅用于顾客吃饭，厨房用于厨师做饭，厨房的门上面一般还会写着：“厨房重地，闲人免进”，也就是顾客一般不具有直接使用厨房的特性。
{: .prompt-tip }

所以，当我们使用 TCP 发送数据的时候，需要先将数据从用户空间拷贝到内核空间，再由内核操作将数据从内核空间发送出去；当我们使用 TCP 读取数据的时候，数据现在内核空间准备好，再从内核空间拷贝到用户空间供用户进程使用。

> 也就好比，当我们在饭店吃饭的时候，先在客厅点好菜，再由服务员将我们的菜单传递进厨房；当厨房做好了菜，再从厨房由服务员传递到客厅一样。
{: .prompt-tip }

因而，一次 IO 的读取操作分为两个阶段（写入操作类似）：
- 等待内核空间数据准备阶段
- 数据从内核空间拷贝到用户空间

为此，Unix 根据这两个阶段将 IO 分成了以下 5 种 IO 模型：
- 阻塞型 IO
- 非阻塞型 IO
- IO 多路复用
- 信号驱动
- 异步 IO


## 阻塞型 IO

阻塞型 IO，即当用户进程发起请求时，一直阻塞到数据拷贝到用户空间为止才返回。

阻塞型 IO 在两个阶段是连续阻塞着的，直到数据返回。

> 好比，早上你买煎饼果子的时候，只有一辆车一个老板
{: .prompt-tip }


## 非阻塞型 IO

## IO 多路复用

## 信号驱动

## 异步 IO